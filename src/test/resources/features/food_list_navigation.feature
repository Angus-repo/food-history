# language: zh-TW
功能: 保留搜尋上下文的食物編輯
  作為一個使用者
  我想要在編輯食物後回到原本的搜尋結果位置
  以便我可以繼續瀏覽和編輯其他搜尋結果

  場景: 從搜尋結果點擊食物編輯後按返回
    假如 我已登入系統
    而且 資料庫中有以下食物:
      | id  | name           | carbGrams |
      | 100 | 麥當勞大麥克   | 45.0      |
      | 101 | 麥當勞薯條     | 35.0      |
      | 102 | 麥當勞可樂     | 39.0      |
    當 我訪問食物列表頁面
    而且 我輸入關鍵字 "麥當勞" 進行搜尋
    那麼 我應該看到 3 筆搜尋結果
    當 我點擊 ID 為 100 的食物卡片
    那麼 編輯頁面的 URL 應該包含參數 "keyword" 值為 "麥當勞"
    而且 編輯頁面的 URL 應該包含參數 "page" 值為 "0"
    而且 編輯頁面的 URL 應該包含參數 "foodId" 值為 "100"
    而且 頁面應該顯示隱藏欄位 "returnKeyword" 值為 "麥當勞"
    而且 頁面應該顯示隱藏欄位 "returnPage" 值為 "0"

  場景: 從搜尋結果編輯並更新食物
    假如 我已登入系統
    而且 資料庫中有以下食物:
      | id  | name     | carbGrams |
      | 200 | 富士蘋果 | 14.0      |
    當 我訪問食物列表頁面
    而且 我輸入關鍵字 "蘋果" 進行搜尋
    而且 我點擊 ID 為 200 的食物卡片
    而且 我修改食物名稱為 "紅富士蘋果"
    而且 我點擊 "更新食物" 按鈕
    那麼 我應該看到成功訊息 "食物資料已成功儲存"
    而且 重定向 URL 應該包含 "keyword" 參數且值為 URL 編碼的 "蘋果"
    而且 重定向 URL 應該包含 "#food-200" 錨點

  場景: 搜尋中文關鍵字並確保 URL 編碼正確
    假如 我已登入系統
    而且 資料庫中有以下食物:
      | id  | name           | carbGrams |
      | 300 | 麥當勞雞塊     | 15.0      |
    當 我訪問食物列表頁面
    而且 我輸入關鍵字 "麥當勞" 進行搜尋
    而且 我點擊 ID 為 300 的食物卡片
    而且 我更新食物
    那麼 重定向的 Location header 應該是有效的
    而且 重定向 URL 應該包含 URL 編碼的中文 "%E9%BA%A5%E7%95%B6%E5%8B%9E"

  場景: 從一般列表編輯食物（無搜尋關鍵字）
    假如 我已登入系統
    而且 資料庫中有以下食物:
      | id  | name   | carbGrams |
      | 400 | 白米飯 | 28.0      |
    當 我訪問食物列表頁面
    而且 我點擊 ID 為 400 的食物卡片
    那麼 編輯頁面的 URL 不應該包含 "keyword" 參數
    當 我更新食物
    那麼 重定向 URL 不應該包含 "keyword" 參數
    而且 重定向 URL 應該包含 "#food-400" 錨點

  場景: 上傳無效圖片格式時保留上下文
    假如 我已登入系統
    而且 資料庫中有以下食物:
      | id  | name       | carbGrams |
      | 500 | 夏威夷披薩 | 30.0      |
    當 我訪問食物列表頁面
    而且 我輸入關鍵字 "披薩" 進行搜尋
    而且 我點擊 ID 為 500 的食物卡片
    而且 我嘗試上傳一個無效的圖片檔案
    而且 我點擊 "更新食物" 按鈕
    那麼 我應該看到錯誤訊息 "只支援 JPEG、PNG 或 GIF 格式的圖片"
    而且 重定向 URL 應該包含 "keyword" 參數
    而且 重定向 URL 應該包含 "page" 參數
    而且 重定向 URL 應該包含 "foodId" 參數
